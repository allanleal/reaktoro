// Reaktoro is a unified framework for modeling chemically reactive systems.
//
// Copyright Â© 2014-2022 Allan Leal
//
// This library is free software; you can redistribute it and/or
// modify it under the terms of the GNU Lesser General Public
// License as published by the Free Software Foundation; either
// version 2.1 of the License, or (at your option) any later version.
//
// This library is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU
// Lesser General Public License for more details.
//
// You should have received a copy of the GNU Lesser General Public License
// along with this library. If not, see <http://www.gnu.org/licenses/>.

#include "WaterInterpolation.hpp"

// Reaktoro includes
#include <Reaktoro/Common/InterpolationUtils.hpp>

namespace Reaktoro {

/// The pressures for interpolation of water properties (in MPa).
/// Pressures are the same used in Table 13.2 of *Wagner, W., Pruss, A. (2002). The IAPWS
/// Formulation 1995 for the Thermodynamic Properties of Ordinary Water Substance for General and
/// Scientific Use. Journal of Physical and Chemical Reference Data, 31(2), 387.
/// https://doi.org/10.1063/1.1461829*.
const Vec<double> pressures = { 0.05, 0.1, 0.101325, 0.25, 0.5, 0.75, 1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 10, 12.5, 15.0, 17.5, 20.0, 22.5, 25.0, 30.0, 40.0, 50.0, 75.0, 100, 200, 400, 600, 800, 1000 };

/// The temperatures for interpolation of water properties (in K).
/// Temperatures are the same used in Table 13.2 of *Wagner, W., Pruss, A. (2002). The IAPWS
/// Formulation 1995 for the Thermodynamic Properties of Ordinary Water Substance for General and
/// Scientific Use. Journal of Physical and Chemical Reference Data, 31(2), 387.
/// https://doi.org/10.1063/1.1461829*.
const Vec<Vec<double>> temperatures =
{
    { 273.156, 275.000, 280.000, 285.000, 290.000, 295.000, 300.000, 305.000, 310.000, 315.000, 320.000, 325.000, 330.000, 335.000, 340.000, 345.000, 350.000, 354.467, 354.467, 355.000, 360.000, 365.000, 370.000, 375.000, 380.000, 385.000, 390.000, 395.000, 400.000, 410.000, 420.000, 430.000, 440.000, 450.000, 460.000, 470.000, 480.000, 490.000, 500.000, 510.000, 520.000, 530.000, 540.000, 550.000, 560.000, 570.000, 580.000, 590.000, 600.000, 610.000, 620.000, 630.000, 640.000, 650.000, 675.000, 700.000, 725.000, 750.000, 775.000, 800.000, 825.000, 850.000, 900.000, 950.000, 1000.000, 1050.000, 1100.000, 1150.000, 1200.000, 1250.000, 1273.000 },
    { 273.153, 275.000, 280.000, 285.000, 290.000, 295.000, 300.000, 305.000, 310.000, 315.000, 320.000, 325.000, 330.000, 335.000, 340.000, 345.000, 350.000, 355.000, 360.000, 365.000, 370.000, 372.756, 372.756, 375.000, 380.000, 385.000, 390.000, 395.000, 400.000, 410.000, 420.000, 430.000, 440.000, 450.000, 460.000, 470.000, 480.000, 490.000, 500.000, 510.000, 520.000, 530.000, 540.000, 550.000, 560.000, 570.000, 580.000, 590.000, 600.000, 610.000, 620.000, 630.000, 640.000, 650.000, 675.000, 700.000, 725.000, 750.000, 775.000, 800.000, 825.000, 850.000, 900.000, 950.000, 1000.000, 1050.000, 1100.000, 1150.000, 1200.000, 1250.000, 1273.000 },
    { 273.153, 275.000, 280.000, 285.000, 290.000, 295.000, 300.000, 305.000, 310.000, 315.000, 320.000, 325.000, 330.000, 335.000, 340.000, 345.000, 350.000, 355.000, 360.000, 365.000, 370.000, 373.124, 373.124, 375.000, 380.000, 385.000, 390.000, 395.000, 400.000, 410.000, 420.000, 430.000, 440.000, 450.000, 460.000, 470.000, 480.000, 490.000, 500.000, 510.000, 520.000, 530.000, 540.000, 550.000, 560.000, 570.000, 580.000, 590.000, 600.000, 610.000, 620.000, 630.000, 640.000, 650.000, 675.000, 700.000, 725.000, 750.000, 775.000, 800.000, 825.000, 850.000, 900.000, 950.000, 1000.000, 1050.000, 1100.000, 1150.000, 1200.000, 1250.000, 1273.000 },
    { 273.142, 275.000, 280.000, 285.000, 290.000, 295.000, 300.000, 305.000, 310.000, 315.000, 320.000, 325.000, 330.000, 335.000, 340.000, 345.000, 350.000, 355.000, 360.000, 365.000, 370.000, 375.000, 380.000, 385.000, 390.000, 395.000, 400.000, 400.561, 400.561, 410.000, 420.000, 430.000, 440.000, 450.000, 460.000, 470.000, 480.000, 490.000, 500.000, 510.000, 520.000, 530.000, 540.000, 550.000, 560.000, 570.000, 580.000, 590.000, 600.000, 610.000, 620.000, 630.000, 640.000, 650.000, 675.000, 700.000, 725.000, 750.000, 775.000, 800.000, 825.000, 850.000, 900.000, 950.000, 1000.000, 1050.000, 1100.000, 1150.000, 1200.000, 1250.000, 1273.000 },
    { 273.123, 275.000, 280.000, 285.000, 290.000, 295.000, 300.000, 305.000, 310.000, 315.000, 320.000, 325.000, 330.000, 335.000, 340.000, 345.000, 350.000, 355.000, 360.000, 365.000, 370.000, 375.000, 380.000, 385.000, 390.000, 395.000, 400.000, 410.000, 420.000, 424.981, 424.981, 430.000, 440.000, 450.000, 460.000, 470.000, 480.000, 490.000, 500.000, 510.000, 520.000, 530.000, 540.000, 550.000, 560.000, 570.000, 580.000, 590.000, 600.000, 610.000, 620.000, 630.000, 640.000, 650.000, 675.000, 700.000, 725.000, 750.000, 775.000, 800.000, 825.000, 850.000, 900.000, 950.000, 1000.000, 1050.000, 1100.000, 1150.000, 1200.000, 1250.000, 1273.000 },
    { 273.105, 275.000, 280.000, 285.000, 290.000, 295.000, 300.000, 305.000, 310.000, 315.000, 320.000, 325.000, 330.000, 335.000, 340.000, 345.000, 350.000, 355.000, 360.000, 365.000, 370.000, 375.000, 380.000, 385.000, 390.000, 395.000, 400.000, 410.000, 420.000, 430.000, 440.000, 440.899, 440.899, 450.000, 460.000, 470.000, 480.000, 490.000, 500.000, 510.000, 520.000, 530.000, 540.000, 550.000, 560.000, 570.000, 580.000, 590.000, 600.000, 610.000, 620.000, 630.000, 640.000, 650.000, 675.000, 700.000, 725.000, 750.000, 775.000, 800.000, 825.000, 850.000, 900.000, 950.000, 1000.000, 1050.000, 1100.000, 1150.000, 1200.000, 1250.000, 1273.000 },
    { 273.086, 275.000, 280.000, 285.000, 290.000, 295.000, 300.000, 305.000, 310.000, 315.000, 320.000, 325.000, 330.000, 335.000, 340.000, 345.000, 350.000, 355.000, 360.000, 365.000, 370.000, 375.000, 380.000, 385.000, 390.000, 395.000, 400.000, 410.000, 420.000, 430.000, 440.000, 450.000, 453.028, 453.028, 460.000, 470.000, 480.000, 490.000, 500.000, 510.000, 520.000, 530.000, 540.000, 550.000, 560.000, 570.000, 580.000, 590.000, 600.000, 610.000, 620.000, 630.000, 640.000, 650.000, 675.000, 700.000, 725.000, 750.000, 775.000, 800.000, 825.000, 850.000, 900.000, 950.000, 1000.000, 1050.000, 1100.000, 1150.000, 1200.000, 1250.000, 1273.000 },
    { 273.012, 275.000, 280.000, 285.000, 290.000, 295.000, 300.000, 305.000, 310.000, 315.000, 320.000, 325.000, 330.000, 335.000, 340.000, 345.000, 350.000, 355.000, 360.000, 365.000, 370.000, 375.000, 380.000, 385.000, 390.000, 395.000, 400.000, 410.000, 420.000, 430.000, 440.000, 450.000, 460.000, 470.000, 480.000, 485.527, 485.527, 490.000, 500.000, 510.000, 520.000, 530.000, 540.000, 550.000, 560.000, 570.000, 580.000, 590.000, 600.000, 610.000, 620.000, 630.000, 640.000, 650.000, 675.000, 700.000, 725.000, 750.000, 775.000, 800.000, 825.000, 850.000, 900.000, 950.000, 1000.000, 1050.000, 1100.000, 1150.000, 1200.000, 1250.000, 1273.000 },
    { 272.938, 275.000, 280.000, 285.000, 290.000, 295.000, 300.000, 305.000, 310.000, 315.000, 320.000, 325.000, 330.000, 335.000, 340.000, 345.000, 350.000, 355.000, 360.000, 365.000, 370.000, 375.000, 380.000, 385.000, 390.000, 395.000, 400.000, 410.000, 420.000, 430.000, 440.000, 450.000, 460.000, 470.000, 480.000, 490.000, 500.000, 507.003, 507.003, 510.000, 520.000, 530.000, 540.000, 550.000, 560.000, 570.000, 580.000, 590.000, 600.000, 610.000, 620.000, 630.000, 640.000, 650.000, 675.000, 700.000, 725.000, 750.000, 775.000, 800.000, 825.000, 850.000, 900.000, 950.000, 1000.000, 1050.000, 1100.000, 1150.000, 1200.000, 1250.000, 1273.000 },
    { 272.863, 275.000, 280.000, 285.000, 290.000, 295.000, 300.000, 305.000, 310.000, 315.000, 320.000, 325.000, 330.000, 335.000, 340.000, 345.000, 350.000, 355.000, 360.000, 365.000, 370.000, 375.000, 380.000, 385.000, 390.000, 395.000, 400.000, 410.000, 420.000, 430.000, 440.000, 450.000, 460.000, 470.000, 480.000, 490.000, 500.000, 510.000, 520.000, 523.504, 523.504, 530.000, 540.000, 550.000, 560.000, 570.000, 580.000, 590.000, 600.000, 610.000, 620.000, 630.000, 640.000, 650.000, 675.000, 700.000, 725.000, 750.000, 775.000, 800.000, 825.000, 850.000, 900.000, 950.000, 1000.000, 1050.000, 1100.000, 1150.000, 1200.000, 1250.000, 1273.000 },
    { 272.788, 275.000, 280.000, 285.000, 290.000, 295.000, 300.000, 305.000, 310.000, 315.000, 320.000, 325.000, 330.000, 335.000, 340.000, 345.000, 350.000, 355.000, 360.000, 365.000, 370.000, 375.000, 380.000, 385.000, 390.000, 395.000, 400.000, 410.000, 420.000, 430.000, 440.000, 450.000, 460.000, 470.000, 480.000, 490.000, 500.000, 510.000, 520.000, 530.000, 537.091, 537.091, 540.000, 550.000, 560.000, 570.000, 580.000, 590.000, 600.000, 610.000, 620.000, 630.000, 640.000, 650.000, 675.000, 700.000, 725.000, 750.000, 775.000, 800.000, 825.000, 850.000, 900.000, 950.000, 1000.000, 1050.000, 1100.000, 1150.000, 1200.000, 1250.000, 1273.000 },
    { 272.713, 275.000, 280.000, 285.000, 290.000, 295.000, 300.000, 305.000, 310.000, 315.000, 320.000, 325.000, 330.000, 335.000, 340.000, 345.000, 350.000, 355.000, 360.000, 365.000, 370.000, 375.000, 380.000, 385.000, 390.000, 395.000, 400.000, 410.000, 420.000, 430.000, 440.000, 450.000, 460.000, 470.000, 480.000, 490.000, 500.000, 510.000, 520.000, 530.000, 540.000, 548.735, 548.735, 550.000, 560.000, 570.000, 580.000, 590.000, 600.000, 610.000, 620.000, 630.000, 640.000, 650.000, 675.000, 700.000, 725.000, 750.000, 775.000, 800.000, 825.000, 850.000, 900.000, 950.000, 1000.000, 1050.000, 1100.000, 1150.000, 1200.000, 1250.000, 1273.000 },
    { 272.638, 275.000, 280.000, 285.000, 290.000, 295.000, 300.000, 305.000, 310.000, 315.000, 320.000, 325.000, 330.000, 335.000, 340.000, 345.000, 350.000, 355.000, 360.000, 365.000, 370.000, 375.000, 380.000, 385.000, 390.000, 395.000, 400.000, 410.000, 420.000, 430.000, 440.000, 450.000, 460.000, 470.000, 480.000, 490.000, 500.000, 510.000, 520.000, 530.000, 540.000, 550.000, 558.979, 558.979, 560.000, 570.000, 580.000, 590.000, 600.000, 610.000, 620.000, 630.000, 640.000, 650.000, 675.000, 700.000, 725.000, 750.000, 775.000, 800.000, 825.000, 850.000, 900.000, 950.000, 1000.000, 1050.000, 1100.000, 1150.000, 1200.000, 1250.000, 1273.000 },
    { 272.562, 275.000, 280.000, 285.000, 290.000, 295.000, 300.000, 305.000, 310.000, 315.000, 320.000, 325.000, 330.000, 335.000, 340.000, 345.000, 350.000, 355.000, 360.000, 365.000, 370.000, 375.000, 380.000, 385.000, 390.000, 395.000, 400.000, 410.000, 420.000, 430.000, 440.000, 450.000, 460.000, 470.000, 480.000, 490.000, 500.000, 510.000, 520.000, 530.000, 540.000, 550.000, 560.000, 568.158, 568.158, 570.000, 580.000, 590.000, 600.000, 610.000, 620.000, 630.000, 640.000, 650.000, 675.000, 700.000, 725.000, 750.000, 775.000, 800.000, 825.000, 850.000, 900.000, 950.000, 1000.000, 1050.000, 1100.000, 1150.000, 1200.000, 1250.000, 1273.000 },
    { 272.410, 275.000, 280.000, 285.000, 290.000, 295.000, 300.000, 305.000, 310.000, 315.000, 320.000, 325.000, 330.000, 335.000, 340.000, 345.000, 350.000, 355.000, 360.000, 365.000, 370.000, 375.000, 380.000, 385.000, 390.000, 395.000, 400.000, 410.000, 420.000, 430.000, 440.000, 450.000, 460.000, 470.000, 480.000, 490.000, 500.000, 510.000, 520.000, 530.000, 540.000, 550.000, 560.000, 570.000, 580.000, 584.147, 584.147, 590.000, 600.000, 610.000, 620.000, 630.000, 640.000, 650.000, 675.000, 700.000, 725.000, 750.000, 775.000, 800.000, 825.000, 850.000, 900.000, 950.000, 1000.000, 1050.000, 1100.000, 1150.000, 1200.000, 1250.000, 1273.000 },
    { 272.218, 275.000, 280.000, 285.000, 290.000, 295.000, 300.000, 305.000, 310.000, 315.000, 320.000, 325.000, 330.000, 335.000, 340.000, 345.000, 350.000, 355.000, 360.000, 365.000, 370.000, 375.000, 380.000, 385.000, 390.000, 395.000, 400.000, 410.000, 420.000, 430.000, 440.000, 450.000, 460.000, 470.000, 480.000, 490.000, 500.000, 510.000, 520.000, 530.000, 540.000, 550.000, 560.000, 570.000, 580.000, 590.000, 600.000, 600.963, 600.963, 610.000, 620.000, 630.000, 640.000, 650.000, 675.000, 700.000, 725.000, 750.000, 775.000, 800.000, 825.000, 850.000, 900.000, 950.000, 1000.000, 1050.000, 1100.000, 1150.000, 1200.000, 1250.000, 1273.000 },
    { 272.025, 275.000, 280.000, 285.000, 290.000, 295.000, 300.000, 305.000, 310.000, 315.000, 320.000, 325.000, 330.000, 335.000, 340.000, 345.000, 350.000, 355.000, 360.000, 365.000, 370.000, 375.000, 380.000, 385.000, 390.000, 395.000, 400.000, 410.000, 420.000, 430.000, 440.000, 450.000, 460.000, 470.000, 480.000, 490.000, 500.000, 510.000, 520.000, 530.000, 540.000, 550.000, 560.000, 570.000, 580.000, 590.000, 600.000, 610.000, 615.305, 615.305, 620.000, 630.000, 640.000, 650.000, 675.000, 700.000, 725.000, 750.000, 775.000, 800.000, 825.000, 850.000, 900.000, 950.000, 1000.000, 1050.000, 1100.000, 1150.000, 1200.000, 1250.000, 1273.000 },
    { 271.830, 275.000, 280.000, 285.000, 290.000, 295.000, 300.000, 305.000, 310.000, 315.000, 320.000, 325.000, 330.000, 335.000, 340.000, 345.000, 350.000, 355.000, 360.000, 365.000, 370.000, 375.000, 380.000, 385.000, 390.000, 395.000, 400.000, 410.000, 420.000, 430.000, 440.000, 450.000, 460.000, 470.000, 480.000, 490.000, 500.000, 510.000, 520.000, 530.000, 540.000, 550.000, 560.000, 570.000, 580.000, 590.000, 600.000, 610.000, 620.000, 627.821, 627.821, 630.000, 640.000, 650.000, 675.000, 700.000, 725.000, 750.000, 775.000, 800.000, 825.000, 850.000, 900.000, 950.000, 1000.000, 1050.000, 1100.000, 1150.000, 1200.000, 1250.000, 1273.000 },
    { 271.633, 275.000, 280.000, 285.000, 290.000, 295.000, 300.000, 305.000, 310.000, 315.000, 320.000, 325.000, 330.000, 335.000, 340.000, 345.000, 350.000, 355.000, 360.000, 365.000, 370.000, 375.000, 380.000, 385.000, 390.000, 395.000, 400.000, 410.000, 420.000, 430.000, 440.000, 450.000, 460.000, 470.000, 480.000, 490.000, 500.000, 510.000, 520.000, 530.000, 540.000, 550.000, 560.000, 570.000, 580.000, 590.000, 600.000, 610.000, 620.000, 630.000, 638.899, 638.899, 640.000, 650.000, 675.000, 700.000, 725.000, 750.000, 775.000, 800.000, 825.000, 850.000, 900.000, 950.000, 1000.000, 1050.000, 1100.000, 1150.000, 1200.000, 1250.000, 1273.000 },
    { 271.435, 275.000, 280.000, 285.000, 290.000, 295.000, 300.000, 305.000, 310.000, 315.000, 320.000, 325.000, 330.000, 335.000, 340.000, 345.000, 350.000, 355.000, 360.000, 365.000, 370.000, 375.000, 380.000, 385.000, 390.000, 395.000, 400.000, 410.000, 420.000, 430.000, 440.000, 450.000, 460.000, 470.000, 480.000, 490.000, 500.000, 510.000, 520.000, 530.000, 540.000, 550.000, 560.000, 570.000, 580.000, 590.000, 600.000, 610.000, 620.000, 630.000, 640.000, 650.000, 675.000, 700.000, 725.000, 750.000, 775.000, 800.000, 825.000, 850.000, 900.000, 950.000, 1000.000, 1050.000, 1100.000, 1150.000, 1200.000, 1250.000, 1273.000 },
    { 271.235, 275.000, 280.000, 285.000, 290.000, 295.000, 300.000, 305.000, 310.000, 315.000, 320.000, 325.000, 330.000, 335.000, 340.000, 345.000, 350.000, 355.000, 360.000, 365.000, 370.000, 375.000, 380.000, 385.000, 390.000, 395.000, 400.000, 410.000, 420.000, 430.000, 440.000, 450.000, 460.000, 470.000, 480.000, 490.000, 500.000, 510.000, 520.000, 530.000, 540.000, 550.000, 560.000, 570.000, 580.000, 590.000, 600.000, 610.000, 620.000, 630.000, 640.000, 650.000, 675.000, 700.000, 725.000, 750.000, 775.000, 800.000, 825.000, 850.000, 900.000, 950.000, 1000.000, 1050.000, 1100.000, 1150.000, 1200.000, 1250.000, 1273.000 },
    { 270.829, 275.000, 280.000, 285.000, 290.000, 295.000, 300.000, 305.000, 310.000, 315.000, 320.000, 325.000, 330.000, 335.000, 340.000, 345.000, 350.000, 355.000, 360.000, 365.000, 370.000, 375.000, 380.000, 385.000, 390.000, 395.000, 400.000, 410.000, 420.000, 430.000, 440.000, 450.000, 460.000, 470.000, 480.000, 490.000, 500.000, 510.000, 520.000, 530.000, 540.000, 550.000, 560.000, 570.000, 580.000, 590.000, 600.000, 610.000, 620.000, 630.000, 640.000, 650.000, 675.000, 700.000, 725.000, 750.000, 775.000, 800.000, 825.000, 850.000, 900.000, 950.000, 1000.000, 1050.000, 1100.000, 1150.000, 1200.000, 1250.000, 1273.000 },
    { 269.997, 270.000, 275.000, 280.000, 285.000, 290.000, 295.000, 300.000, 305.000, 310.000, 315.000, 320.000, 325.000, 330.000, 335.000, 340.000, 345.000, 350.000, 355.000, 360.000, 365.000, 370.000, 375.000, 380.000, 385.000, 390.000, 395.000, 400.000, 410.000, 420.000, 430.000, 440.000, 450.000, 460.000, 470.000, 480.000, 490.000, 500.000, 510.000, 520.000, 530.000, 540.000, 550.000, 560.000, 570.000, 580.000, 590.000, 600.000, 610.000, 620.000, 630.000, 640.000, 650.000, 675.000, 700.000, 725.000, 750.000, 775.000, 800.000, 825.000, 850.000, 900.000, 950.000, 1000.000, 1050.000, 1100.000, 1150.000, 1200.000, 1250.000, 1273.000 },
    { 269.134, 270.000, 275.000, 280.000, 285.000, 290.000, 295.000, 300.000, 305.000, 310.000, 315.000, 320.000, 325.000, 330.000, 335.000, 340.000, 345.000, 350.000, 355.000, 360.000, 365.000, 370.000, 375.000, 380.000, 385.000, 390.000, 395.000, 400.000, 410.000, 420.000, 430.000, 440.000, 450.000, 460.000, 470.000, 480.000, 490.000, 500.000, 510.000, 520.000, 530.000, 540.000, 550.000, 560.000, 570.000, 580.000, 590.000, 600.000, 610.000, 620.000, 630.000, 640.000, 650.000, 675.000, 700.000, 725.000, 750.000, 775.000, 800.000, 825.000, 850.000, 900.000, 950.000, 1000.000, 1050.000, 1100.000, 1150.000, 1200.000, 1250.000, 1273.000 },
    { 266.843, 270.000, 275.000, 280.000, 285.000, 290.000, 295.000, 300.000, 305.000, 310.000, 315.000, 320.000, 325.000, 330.000, 335.000, 340.000, 345.000, 350.000, 355.000, 360.000, 365.000, 370.000, 375.000, 380.000, 385.000, 390.000, 395.000, 400.000, 410.000, 420.000, 430.000, 440.000, 450.000, 460.000, 470.000, 480.000, 490.000, 500.000, 510.000, 520.000, 530.000, 540.000, 550.000, 560.000, 570.000, 580.000, 590.000, 600.000, 610.000, 620.000, 630.000, 640.000, 650.000, 675.000, 700.000, 725.000, 750.000, 775.000, 800.000, 825.000, 850.000, 900.000, 950.000, 1000.000, 1050.000, 1100.000, 1150.000, 1200.000, 1250.000, 1273.000 },
    { 264.347, 265.000, 270.000, 275.000, 280.000, 285.000, 290.000, 295.000, 300.000, 305.000, 310.000, 315.000, 320.000, 325.000, 330.000, 335.000, 340.000, 345.000, 350.000, 355.000, 360.000, 365.000, 370.000, 375.000, 380.000, 385.000, 390.000, 395.000, 400.000, 410.000, 420.000, 430.000, 440.000, 450.000, 460.000, 470.000, 480.000, 490.000, 500.000, 510.000, 520.000, 530.000, 540.000, 550.000, 560.000, 570.000, 580.000, 590.000, 600.000, 610.000, 620.000, 630.000, 640.000, 650.000, 675.000, 700.000, 725.000, 750.000, 775.000, 800.000, 825.000, 850.000, 900.000, 950.000, 1000.000, 1050.000, 1100.000, 1150.000, 1200.000, 1250.000, 1273.000 },
    { 252.462, 255.000, 260.000, 265.000, 270.000, 275.000, 280.000, 285.000, 290.000, 295.000, 300.000, 305.000, 310.000, 315.000, 320.000, 325.000, 330.000, 335.000, 340.000, 345.000, 350.000, 355.000, 360.000, 365.000, 370.000, 375.000, 380.000, 385.000, 390.000, 395.000, 400.000, 410.000, 420.000, 430.000, 440.000, 450.000, 460.000, 470.000, 480.000, 490.000, 500.000, 510.000, 520.000, 530.000, 540.000, 550.000, 560.000, 570.000, 580.000, 590.000, 600.000, 610.000, 620.000, 630.000, 640.000, 650.000, 675.000, 700.000, 725.000, 750.000, 775.000, 800.000, 825.000, 850.000, 900.000, 950.000, 1000.000, 1050.000, 1100.000, 1150.000, 1200.000, 1250.000, 1273.000 },
    { 259.820, 260.000, 265.000, 270.000, 275.000, 280.000, 285.000, 290.000, 295.000, 300.000, 305.000, 310.000, 315.000, 320.000, 325.000, 330.000, 335.000, 340.000, 345.000, 350.000, 355.000, 360.000, 365.000, 370.000, 375.000, 380.000, 385.000, 390.000, 395.000, 400.000, 410.000, 420.000, 430.000, 440.000, 450.000, 460.000, 470.000, 480.000, 490.000, 500.000, 510.000, 520.000, 530.000, 540.000, 550.000, 560.000, 570.000, 580.000, 590.000, 600.000, 610.000, 620.000, 630.000, 640.000, 650.000, 675.000, 700.000, 725.000, 750.000, 775.000, 800.000, 825.000, 850.000, 900.000, 950.000, 1000.000, 1050.000, 1100.000, 1150.000, 1200.000, 1250.000, 1273.000 },
    { 271.691, 275.000, 280.000, 285.000, 290.000, 295.000, 300.000, 305.000, 310.000, 315.000, 320.000, 325.000, 330.000, 335.000, 340.000, 345.000, 350.000, 355.000, 360.000, 365.000, 370.000, 375.000, 380.000, 385.000, 390.000, 395.000, 400.000, 410.000, 420.000, 430.000, 440.000, 450.000, 460.000, 470.000, 480.000, 490.000, 500.000, 510.000, 520.000, 530.000, 540.000, 550.000, 560.000, 570.000, 580.000, 590.000, 600.000, 610.000, 620.000, 630.000, 640.000, 650.000, 675.000, 700.000, 725.000, 750.000, 775.000, 800.000, 825.000, 850.000, 900.000, 950.000, 1000.000, 1050.000, 1100.000, 1150.000, 1200.000, 1250.000, 1273.000 },
    { 286.725, 290.000, 295.000, 300.000, 305.000, 310.000, 315.000, 320.000, 325.000, 330.000, 335.000, 340.000, 345.000, 350.000, 355.000, 360.000, 365.000, 370.000, 375.000, 380.000, 385.000, 390.000, 395.000, 400.000, 410.000, 420.000, 430.000, 440.000, 450.000, 460.000, 470.000, 480.000, 490.000, 500.000, 510.000, 520.000, 530.000, 540.000, 550.000, 560.000, 570.000, 580.000, 590.000, 600.000, 610.000, 620.000, 630.000, 640.000, 650.000, 675.000, 700.000, 725.000, 750.000, 775.000, 800.000, 825.000, 850.000, 900.000, 950.000, 1000.000, 1050.000, 1100.000, 1150.000, 1200.000, 1250.000, 1273.000 },
    { 300.243, 305.000, 310.000, 315.000, 320.000, 325.000, 330.000, 335.000, 340.000, 345.000, 350.000, 355.000, 360.000, 365.000, 370.000, 375.000, 380.000, 385.000, 390.000, 395.000, 400.000, 410.000, 420.000, 430.000, 440.000, 450.000, 460.000, 470.000, 480.000, 490.000, 500.000, 510.000, 520.000, 530.000, 540.000, 550.000, 560.000, 570.000, 580.000, 590.000, 600.000, 610.000, 620.000, 630.000, 640.000, 650.000, 675.000, 700.000, 725.000, 750.000, 775.000, 800.000, 825.000, 850.000, 900.000, 950.000, 1000.000, 1050.000, 1100.000, 1150.000, 1200.000, 1250.000, 1273.000 },
};

/// The state of matter of water at the temperatures and pressures used for interpolation (L: liquid, G: gaseous, S: supercritical).
const Vec<Vec<char>> stateofmatter =
{
    { 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G' },           // 0.05MPa
    { 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G' },           // 0.1MPa
    { 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G' },           // 0.101325MPa
    { 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G' },           // 0.25MPa
    { 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G' },           // 0.5MPa
    { 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G' },           // 0.75MPa
    { 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G' },           // 1.0MPa
    { 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G' },           // 2.0MPa
    { 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G' },           // 3.0MPa
    { 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G' },           // 4.0MPa
    { 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G' },           // 5.0MPa
    { 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G' },           // 6.0MPa
    { 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G' },           // 7.0MPa
    { 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G' },           // 8.0MPa
    { 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G' },           // 10MPa
    { 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G' },           // 12.5MPa
    { 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G' },           // 15.0MPa
    { 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G' },           // 17.5MPa
    { 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'L', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G' },           // 20.0MPa
    { 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S' },                     // 22.5MPa
    { 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S' },                     // 25.0MPa
    { 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S' },                     // 30.0MPa
    { 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S' },                // 40.0MPa
    { 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S' },                // 50.0MPa
    { 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S' },                // 75.0MPa
    { 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S' },           // 100MPa
    { 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S' }, // 200MPa
    { 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S' },      // 400MPa
    { 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S' },                     // 600MPa
    { 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S' },                                    // 800MPa
    { 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S' },                                                   // 1000MPa
};

/// The first temperature index, for each pressure row, at which water has changed its state of matter from liquid to gas. The index 99 is used for pressures above supercritical value.
const Vec<Index> transitions = { 18, 22, 22, 28, 30, 32, 33, 36, 38, 40, 41, 42, 43, 44, 46, 48, 49, 50, 51, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99 };

/// The density of water at the temperatures and pressures used for interpolation (in kg/m3).
/// Density values collected from Table 13.2 in *Wagner, W., Pruss, A. (2002). The IAPWS Formulation
/// 1995 for the Thermodynamic Properties of Ordinary Water Substance for General and Scientific
/// Use. Journal of Physical and Chemical Reference Data, 31(2), 387.
/// https://doi.org/10.1063/1.1461829*.
const Vec<Vec<double>> densities =
{
    {  999.81700,  999.91200,  999.88600,  999.49300,  998.78000,  997.78400,  996.53400,  995.05300,  993.36100,  991.47400,  989.40400,  987.16500,  984.76400,  982.21200,  979.51300,  976.67600,  973.70600,  970.94200,    0.30864,    0.30815,    0.30366,    0.29931,    0.29510,    0.29101,    0.28705,    0.28320,    0.27947,    0.27583,    0.27229,    0.26550,    0.25905,    0.25292,    0.24708,    0.24151,    0.23620,    0.23112,    0.22625,    0.22159,    0.21712,    0.21283,    0.20871,    0.20474,    0.20093,    0.19726,    0.19371,    0.19030,    0.18700,    0.18382,    0.18075,    0.17777,    0.17489,    0.17211,    0.16941,    0.16680,    0.16060,    0.15485,    0.14950,    0.14451,    0.13984,    0.13547,    0.13136,    0.12749,    0.12040,    0.11406,    0.10835,    0.10319,    0.09850,    0.09421,    0.09029,    0.08667,    0.08511 },
    {  999.84300,  999.93700,  999.91000,  999.51700,  998.80300,  997.80700,  996.55600,  995.07500,  993.38300,  991.49600,  989.42600,  987.18700,  984.78600,  982.23300,  979.53500,  976.69900,  973.72800,  970.62800,  967.40300,  964.05700,  960.59100,  958.63200,    0.59034,    0.58653,    0.57824,    0.57021,    0.56245,    0.55491,    0.54761,    0.53361,    0.52038,    0.50783,    0.49592,    0.48458,    0.47378,    0.46347,    0.45361,    0.44418,    0.43514,    0.42647,    0.41815,    0.41016,    0.40247,    0.39507,    0.38794,    0.38107,    0.37444,    0.36804,    0.36185,    0.35588,    0.35010,    0.34450,    0.33909,    0.33384,    0.32141,    0.30988,    0.29915,    0.28915,    0.27979,    0.27102,    0.26279,    0.25504,    0.24085,    0.22815,    0.21673,    0.20640,    0.19701,    0.18844,    0.18058,    0.17335,    0.17022 },
    {  999.84300,  999.93800,  999.91100,  999.51700,  998.80400,  997.80700,  996.55700,  995.07600,  993.38400,  991.49600,  989.42700,  987.18700,  984.78700,  982.23400,  979.53600,  976.69900,  973.72800,  970.62900,  967.40400,  964.05700,  960.59200,  958.36700,    0.59766,    0.59442,    0.58601,    0.57787,    0.56999,    0.56236,    0.55494,    0.54075,    0.52734,    0.51462,    0.50254,    0.49105,    0.48009,    0.46964,    0.45965,    0.45009,    0.44093,    0.43215,    0.42371,    0.41561,    0.40782,    0.40032,    0.39309,    0.38613,    0.37941,    0.37292,    0.36666,    0.36060,    0.35475,    0.34908,    0.34359,    0.33827,    0.32568,    0.31399,    0.30312,    0.29298,    0.28350,    0.27462,    0.26628,    0.25843,    0.24404,    0.23118,    0.21960,    0.20914,    0.19962,    0.19093,    0.18297,    0.17565,    0.17248 },
    {  999.91800, 1000.01000,  999.98300,  999.58800,  998.87300,  997.87500,  996.62400,  995.14200,  993.44900,  991.56100,  989.49200,  987.25200,  984.85200,  982.29900,  979.60100,  976.76500,  973.79500,  970.69600,  967.47100,  964.12600,  960.66100,  957.08100,  953.38500,  949.57800,  945.65800,  941.62800,  937.48800,  937.01600,    1.39150,    1.35510,    1.31910,    1.28540,    1.25360,    1.22360,    1.19520,    1.16820,    1.14260,    1.11810,    1.09470,    1.07240,    1.05100,    1.03050,    1.01080,    0.99192,    0.97373,    0.95622,    0.93935,    0.92309,    0.90740,    0.89224,    0.87760,    0.86343,    0.84973,    0.83647,    0.80508,    0.77600,    0.74898,    0.72380,    0.70027,    0.67823,    0.65755,    0.63811,    0.60249,    0.57066,    0.54204,    0.51616,    0.49264,    0.47118,    0.45152,    0.43343,    0.42559 },
    { 1000.04000, 1000.14000, 1000.10000,  999.70600,  998.98900,  997.98900,  996.73600,  995.25300,  993.55900,  991.67100,  989.60100,  987.36100,  984.96100,  982.40900,  979.71100,  976.87600,  973.90600,  970.80800,  967.58500,  964.24100,  960.77800,  957.19900,  953.50500,  949.69900,  945.78200,  941.75400,  937.61700,  929.01200,  919.96400,  915.29000,    2.66800,    2.62970,    2.55790,    2.49130,    2.42900,    2.37050,    2.31530,    2.26310,    2.21350,    2.16640,    2.12150,    2.07860,    2.03760,    1.99840,    1.96070,    1.92460,    1.88980,    1.85640,    1.82420,    1.79310,    1.76310,    1.73420,    1.70630,    1.67920,    1.61540,    1.55640,    1.50160,    1.45070,    1.40320,    1.35870,    1.31700,    1.27790,    1.20620,    1.14220,    1.08480,    1.03280,    0.98568,    0.94266,    0.90325,    0.86702,    0.85132 },
    { 1000.17000, 1000.26000, 1000.23000,  999.82400,  999.10400,  998.10300,  996.84800,  995.36400,  993.66900,  991.78000,  989.71000,  987.47000,  985.07000,  982.51800,  979.82100,  976.98600,  974.01800,  970.92000,  967.69900,  964.35500,  960.89400,  957.31600,  953.62500,  949.82100,  945.90600,  941.88000,  937.74500,  929.14500,  920.10400,  910.61300,  900.65900,  899.74100,    3.91370,    3.81090,    3.70730,    3.61130,    3.52170,    3.43770,    3.35860,    3.28380,    3.21290,    3.14560,    3.08140,    3.02020,    2.96160,    2.90560,    2.85180,    2.80020,    2.75060,    2.70290,    2.65690,    2.61250,    2.56980,    2.52840,    2.43100,    2.34120,    2.25800,    2.18070,    2.10870,    2.04150,    1.97850,    1.91930,    1.81120,    1.71470,    1.62820,    1.55000,    1.47910,    1.41440,    1.35520,    1.30080,    1.27720 },
    { 1000.30000, 1000.39000, 1000.35000,  999.94200,  999.22000,  998.21600,  996.96000,  995.47500,  993.77900,  991.89000,  989.81900,  987.57900,  985.17900,  982.62700,  979.93100,  977.09600,  974.12900,  971.03300,  967.81200,  964.47000,  961.01000,  957.43400,  953.74400,  949.94200,  946.02900,  942.00600,  937.87300,  929.27900,  920.24400,  910.76000,  900.81400,  890.38600,  887.12900,    5.14500,    5.03760,    4.89600,    4.76580,    4.64510,    4.53230,    4.42650,    4.32680,    4.23250,    4.14310,    4.05810,    3.97710,    3.89980,    3.82580,    3.75500,    3.68710,    3.62180,    3.55910,    3.49860,    3.44040,    3.38430,    3.25210,    3.13050,    3.01820,    2.91400,    2.81700,    2.72650,    2.64180,    2.56240,    2.41740,    2.28820,    2.17230,    2.06780,    1.97290,    1.88650,    1.80740,    1.73470,    1.70320 },
    { 1000.80000, 1000.89000, 1000.83000, 1000.41000,  999.68200,  998.67000,  997.40800,  995.91700,  994.21800,  992.32600,  990.25400,  988.01400,  985.61400,  983.06400,  980.37000,  977.53800,  974.57300,  971.48100,  968.26500,  964.92800,  961.47400,  957.90500,  954.22200,  950.42700,  946.52300,  942.50800,  938.38500,  929.81200,  920.80200,  911.34600,  901.43200,  891.04100,  880.14700,  868.71600,  856.70500,  849.79800,   10.04200,    9.88900,    9.57810,    9.29900,    9.04470,    8.81050,    8.59340,    8.39080,    8.20080,    8.02190,    7.85300,    7.69280,    7.54060,    7.39570,    7.25730,    7.12500,    6.99830,    6.87670,    6.59300,    6.33460,    6.09780,    5.87960,    5.67760,    5.49010,    5.31520,    5.15180,    4.85470,    4.59120,    4.35580,    4.14390,    3.95210,    3.77770,    3.61820,    3.47190,    3.40850 },
    { 1001.30000, 1001.39000, 1001.32000, 1000.89000, 1000.14000,  999.12300,  997.85400,  996.35900,  994.65700,  992.76200,  990.68900,  988.44800,  986.04900,  983.49900,  980.80700,  977.97800,  975.01700,  971.92800,  968.71700,  965.38500,  961.93700,  958.37300,  954.69800,  950.91100,  947.01400,  943.00900,  938.89500,  930.34400,  921.35800,  911.93000,  902.04800,  891.69300,  880.84100,  869.45800,  857.50400,  844.92400,  831.65200,  821.90000,   15.00100,   14.82800,   14.30900,   13.85200,   13.44200,   13.07000,   12.72900,   12.41300,   12.11900,   11.84500,   11.58700,   11.34300,   11.11300,   10.89400,   10.68700,   10.48800,   10.03000,    9.61740,    9.24240,    8.89930,    8.58370,    8.29200,    8.02120,    7.76900,    7.31240,    6.90950,    6.55060,    6.22850,    5.93770,    5.67360,    5.43250,    5.21160,    5.11600 },
    { 1001.80000, 1001.89000, 1001.80000, 1001.36000, 1000.60000,  999.57500,  998.30000,  996.80000,  995.09400,  993.19700,  991.12300,  988.88100,  986.48200,  983.93400,  981.24400,  978.41700,  975.45900,  972.37400,  969.16700,  965.84100,  962.39800,  958.84100,  955.17200,  951.39300,  947.50500,  943.50800,  939.40400,  930.87300,  921.91100,  912.51100,  902.66000,  892.34200,  881.53100,  870.19600,  858.29600,  845.78200,  832.58600,  818.62700,  803.79600,  798.36800,   20.09000,   19.55300,   18.83100,   18.20200,   17.64200,   17.13600,   16.67500,   16.25100,   15.85700,   15.49100,   15.14700,   14.82500,   14.52000,   14.23200,   13.57200,   12.98500,   12.45600,   11.97600,   11.53700,   11.13400,   10.76100,   10.41500,    9.79100,    9.24300,    8.75680,    8.32170,    7.92960,    7.57420,    7.25040,    6.95380,    6.82560 },
    { 1002.30000, 1002.38000, 1002.28000, 1001.82000, 1001.06000, 1000.03000,  998.74500,  997.24000,  995.53000,  993.63100,  991.55500,  989.31300,  986.91500,  984.36800,  981.67900,  978.85500,  975.90000,  972.81900,  969.61700,  966.29500,  962.85800,  959.30700,  955.64500,  951.87300,  947.99300,  944.00500,  939.91000,  931.40100,  922.46300,  913.09000,  903.27000,  892.98700,  882.21700,  870.92900,  859.08400,  846.63200,  833.51200,  819.64200,  804.92000,  789.20800,  777.36900,   25.35100,   25.00400,   23.95100,   23.05800,   22.27900,   21.58600,   20.96200,   20.39300,   19.87100,   19.38700,   18.93800,   18.51700,   18.12200,   17.22800,   16.44200,   15.74300,   15.11300,   14.54000,   14.01700,   13.53500,   13.09000,   12.29100,   11.59200,   10.97500,   10.42300,    9.92800,    9.47960,    9.07170,    8.69860,    8.53740 },
    { 1002.80000, 1002.88000, 1002.76000, 1002.29000, 1001.52000, 1000.48000,  999.18900,  997.67900,  995.96600,  994.06400,  991.98700,  989.74400,  987.34600,  984.80000,  982.11300,  979.29100,  976.34000,  973.26300,  970.06500,  966.74800,  963.31700,  959.77200,  956.11700,  952.35200,  948.48000,  944.50100,  940.41500,  931.92600,  923.01200,  913.66600,  903.87700,  893.62900,  882.89900,  871.65700,  859.86500,  847.47700,  834.43000,  820.64800,  806.03100,  790.45000,  773.72800,  757.99800,   30.81800,   30.61100,   29.16600,   27.97100,   26.94700,   26.04800,   25.24700,   24.52400,   23.86500,   23.25800,   22.69700,   22.17500,   21.00800,   19.99800,   19.10700,   18.31200,   17.59500,   16.94300,   16.34500,   15.79500,   14.81200,   13.95700,   13.20400,   12.53400,   11.93300,   11.39000,   10.89600,   10.44600,   10.25100 },
    { 1003.30000, 1003.37000, 1003.24000, 1002.76000, 1001.98000, 1000.93000,  999.63200,  998.11700,  996.40100,  994.49600,  992.41700,  990.17400,  987.77700,  985.23200,  982.54700,  979.72700,  976.77900,  973.70600,  970.51200,  967.20000,  963.77400,  960.23600,  956.58700,  952.83000,  948.96600,  944.99500,  940.91900,  932.45000,  923.55900,  914.23900,  904.48100,  894.26800,  883.57700,  872.38100,  860.64200,  848.31500,  835.34000,  821.64300,  807.13000,  791.67600,  775.11300,  757.21100,  739.72400,   36.52500,   36.30400,   34.41900,   32.89400,   31.60600,   30.49000,   29.50300,   28.62000,   27.81900,   27.08600,   26.41100,   24.92500,   23.65800,   22.55400,   21.57800,   20.70400,   19.91300,   19.19200,   18.53100,   17.35600,   16.33800,   15.44500,   14.65300,   13.94400,   13.30500,   12.72500,   12.19600,   11.96700 },
    { 1003.80000, 1003.87000, 1003.72000, 1003.23000, 1002.43000, 1001.37000, 1000.07000,  998.55500,  996.83400,  994.92800,  992.84700,  990.60400,  988.20600,  985.66200,  982.97900,  980.16200,  977.21700,  974.14700,  970.95800,  967.65100,  964.23000,  960.69800,  957.05600,  953.30600,  949.45000,  945.48700,  941.42000,  932.97200,  924.10400,  914.81100,  905.08200,  894.90300,  884.25200,  873.10000,  861.41300,  849.14600,  836.24200,  822.63000,  808.21700,  792.88600,  776.47800,  758.77400,  739.46300,  722.19600,   42.50700,   41.99700,   39.64700,   37.77700,   36.21800,   34.87800,   33.70400,   32.65700,   31.71300,   30.85400,   28.99100,   27.43100,   26.08900,   24.91400,   23.86900,   22.92900,   22.07700,   21.29900,   19.92200,   18.73500,   17.69800,   16.78100,   15.96200,   15.22400,   14.55600,   13.94800,   13.68600 },
    { 1004.79000, 1004.85000, 1004.67000, 1004.16000, 1003.34000, 1002.27000, 1000.96000,  999.42600,  997.69900,  995.78700,  993.70400,  991.45900,  989.06200,  986.52000,  983.84000,  981.02800,  978.08900,  975.02700,  971.84600,  968.54900,  965.13900,  961.61800,  957.99000,  954.25400,  950.41300,  946.46700,  942.41800,  934.00900,  925.18700,  915.94600,  906.27700,  896.16500,  885.59000,  874.52700,  862.94100,  850.79100,  838.02500,  824.57500,  810.35700,  795.26300,  779.14900,  761.82000,  743.00500,  722.29600,  699.04900,  688.42400,   55.46300,   53.01900,   49.77300,   47.23700,   45.15100,   43.38000,   41.84000,   40.47900,   37.63900,   35.35500,   33.44700,   31.81000,   30.37800,   29.10700,   27.96600,   26.93300,   25.12300,   23.58000,   22.24100,   21.06300,   20.01700,   19.07800,   18.23000,   17.46000,   17.12800 },
    { 1006.03000, 1006.07000, 1005.86000, 1005.31000, 1004.47000, 1003.38000, 1002.05000, 1000.51000,  998.77400,  996.85700,  994.77000,  992.52300,  990.12700,  987.58800,  984.91200,  982.10500,  979.17400,  976.12000,  972.94900,  969.66400,  966.26800,  962.76200,  959.14900,  955.43100,  951.60900,  947.68300,  943.65600,  935.29600,  926.52900,  917.35200,  907.75400,  897.72400,  887.24300,  876.28600,  864.82300,  852.81500,  840.21300,  826.95700,  812.97000,  798.15500,  782.38500,  765.49000,  747.23700,  727.28900,  705.13500,  679.92300,  650.03900,  646.80700,   74.09700,   67.91200,   63.18800,   59.61200,   56.73300,   54.32600,   49.62500,   46.08500,   43.25200,   40.89400,   38.87800,   37.12000,   35.56300,   34.16900,   31.75800,   29.73000,   27.98700,   26.46600,   25.12200,   23.92200,   22.84200,   21.86400,   21.44300 },
    { 1007.27000, 1007.29000, 1007.04000, 1006.46000, 1005.60000, 1004.49000, 1003.14000, 1001.59000,  999.84400,  997.92000,  995.83000,  993.58200,  991.18600,  988.64900,  985.97700,  983.17600,  980.25100,  977.20700,  974.04600,  970.77200,  967.38900,  963.89700,  960.30000,  956.59900,  952.79500,  948.89000,  944.88400,  936.57200,  927.85900,  918.74300,  909.21600,  899.26500,  888.87400,  878.02000,  866.67500,  854.80300,  842.35900,  829.28800,  815.52000,  800.96700,  785.51700,  769.02000,  751.27600,  732.00300,  710.78500,  686.96700,  659.40700,  625.74700,  603.51800,   96.72700,   90.36200,   81.55300,   75.64000,   71.18600,   63.33700,   57.94200,   53.85000,   50.56400,   47.82600,   45.48400,   43.44100,   41.63200,   38.54800,   35.98800,   33.81100,   31.92500,   30.26800,   28.79600,   27.47500,   26.28200,   25.77100 },
    { 1008.50000, 1008.50000, 1008.21000, 1007.61000, 1006.72000, 1005.59000, 1004.23000, 1002.66000, 1000.91000,  998.97900,  996.88400,  994.63500,  992.23900,  989.70400,  987.03600,  984.24100,  981.32300,  978.28700,  975.13600,  971.87300,  968.50200,  965.02500,  961.44300,  957.75900,  953.97300,  950.08700,  946.10200,  937.83600,  929.17700,  920.12100,  910.66200,  900.78800,  890.48500,  879.73000,  868.49900,  856.75700,  844.46500,  831.56900,  818.00900,  803.70300,  788.55200,  772.42300,  755.14300,  736.47200,  716.07000,  693.41800,  667.67100,  637.27100,  598.61600,  554.66200,  126.12000,  119.56000,  102.67000,   93.22500,   79.47200,   71.23000,   65.39600,   60.90700,   57.27400,   54.23100,   51.61900,   49.33700,   45.49800,   42.35800,   39.71400,   37.44000,   35.45500,   33.69800,   32.12900,   30.71600,   30.11100 },
    { 1009.72000, 1009.70000, 1009.38000, 1008.74000, 1007.83000, 1006.68000, 1005.31000, 1003.73000, 1001.97000, 1000.03000,  997.93300,  995.68200,  993.28600,  990.75300,  988.08900,  985.29900,  982.38800,  979.36000,  976.21900,  972.96700,  969.60800,  966.14500,  962.57800,  958.91000,  955.14200,  951.27500,  947.31100,  939.09000,  930.48200,  921.48500,  912.09200,  902.29400,  892.07500,  881.41700,  870.29600,  858.68000,  846.53200,  833.80500,  820.44100,  806.36900,  791.49700,  775.71000,  758.85500,  740.72800,  721.04400,  699.38600,  675.10900,  647.11300,  613.22900,  567.64400,  490.18800,  170.50000,  160.50000,  126.49000,   99.22100,   86.38000,   78.08800,   72.02700,   67.28000,   63.39600,   60.12100,   57.29600,   52.61500,   48.84100,   45.69600,   43.01200,   40.68200,   38.63000,   36.80400,   35.16400,   34.46300 },
    { 1010.95000, 1010.90000, 1010.54000, 1009.87000, 1008.94000, 1007.77000, 1006.38000, 1004.79000, 1003.02000, 1001.08000,  998.97600,  996.72300,  994.32800,  991.79700,  989.13600,  986.35100,  983.44700,  980.42700,  977.29500,  974.05400,  970.70700,  967.25700,  963.70500,  960.05300,  956.30200,  952.45400,  948.51000,  940.33400,  931.77600,  922.83600,  913.50800,  903.78200,  893.64600,  883.08100,  872.06600,  860.57100,  848.56200,  835.99600,  822.82000,  808.96900,  794.36000,  778.89100,  762.42800,  744.79400,  725.75000,  704.95400,  681.90000,  655.77800,  625.14900,  586.92700,  531.38500,  218.27800,  124.87000,  104.02000,   92.17800,   84.04300,   77.90900,   73.01700,   68.96700,   65.52300,   59.90300,   55.43900,   51.75700,   48.64000,   45.94900,   43.59100,   41.49900,   39.62600,   38.82700 },
    { 1012.16000, 1012.09000, 1011.69000, 1011.00000, 1010.04000, 1008.85000, 1007.45000, 1005.85000, 1004.07000, 1002.12000, 1000.01000,  997.75900,  995.36400,  992.83400,  990.17700,  987.39700,  984.49900,  981.48700,  978.36500,  975.13400,  971.79900,  968.36200,  964.82400,  961.18800,  957.45400,  953.62400,  949.69900,  941.56700,  933.05900,  924.17400,  914.90900,  905.25400,  895.19800,  884.72400,  873.81100,  862.43300,  850.55800,  838.14600,  825.14900,  811.50600,  797.14500,  781.97300,  765.87300,  748.69000,  730.22100,  710.18300,  688.16900,  663.56300,  635.34900,  601.63500,  557.98000,  488.84600,  161.60000,  125.09000,  107.99000,   97.09800,   89.23200,   83.13200,   78.18100,   74.03200,   67.36700,   62.15300,   57.89900,   54.32400,   51.25600,   48.57900,   46.21300,   44.10100,   43.20200 },
    { 1014.59000, 1014.45000, 1013.98000, 1013.23000, 1012.23000, 1011.00000, 1009.57000, 1007.95000, 1006.15000, 1004.19000, 1002.07000,  999.81500,  997.41900,  994.89300,  992.24200,  989.47200,  986.58600,  983.58900,  980.48400,  977.27400,  973.96200,  970.55000,  967.04000,  963.43400,  959.73300,  955.93900,  952.05200,  944.00300,  935.59000,  926.81300,  917.66900,  908.15000,  898.24800,  887.94700,  877.22900,  866.07300,  854.45100,  842.32800,  829.66400,  816.41000,  802.50500,  787.87300,  772.42400,  756.03700,  738.56300,  719.79900,  699.47300,  677.20000,  652.40900,  624.20300,  591.01100,  549.64000,  332.51000,  184.24000,  146.51000,  127.00000,  114.27000,  105.00000,   97.79600,   91.94300,   82.84000,   75.93600,   70.42000,   65.85700,   61.98400,   58.63600,   55.69800,   53.08900,   51.98300 },
    { 1019.38000, 1019.38000, 1019.09000, 1018.49000, 1017.63000, 1016.54000, 1015.24000, 1013.75000, 1012.08000, 1010.25000, 1008.26000, 1006.13000, 1003.86000, 1001.47000,  998.94500,  996.30600,  993.55200,  990.69000,  987.72100,  984.64900,  981.47700,  978.20800,  974.84300,  971.38500,  967.83600,  964.19600,  960.46800,  956.65200,  948.76100,  940.52600,  931.95000,  923.03100,  913.76500,  904.14500,  894.16100,  883.80000,  873.04500,  861.87600,  850.26800,  838.19200,  825.61300,  812.48900,  798.76800,  784.39200,  769.28700,  753.36200,  736.50500,  718.57700,  699.39600,  678.72500,  656.24900,  631.53600,  603.96800,  515.48000,  383.02000,  264.65000,  206.98000,  176.03000,  156.30000,  142.27000,  131.58000,  116.01000,  104.90000,   96.38900,   89.55000,   83.87300,   79.04600,   74.86700,   71.19600,   69.65000 },
    { 1024.11000, 1024.07000, 1023.62000, 1022.90000, 1021.94000, 1020.77000, 1019.40000, 1017.85000, 1016.13000, 1014.26000, 1012.25000, 1010.11000, 1007.83000, 1005.43000, 1002.91000, 1000.28000,  997.54600,  994.70300,  991.76000,  988.71800,  985.58100,  982.35100,  979.03000,  975.62100,  972.12400,  968.54100,  964.87400,  961.12400,  953.37600,  945.30500,  936.91200,  928.19900,  919.16100,  909.79600,  900.09700,  890.05300,  879.65200,  868.88000,  857.71900,  846.14600,  834.13600,  821.66000,  808.68300,  795.16300,  781.05300,  766.29500,  750.82200,  734.55200,  717.38700,  699.20700,  679.86700,  659.18500,  636.94000,  572.50000,  491.03000,  394.85000,  309.93000,  253.76000,  218.07000,  193.89000,  176.31000,  152.03000,  135.62000,  123.48000,  113.98000,  106.26000,   99.78600,   94.25000,   89.43400,   87.41700 },
    { 1035.67000, 1035.31000, 1034.53000, 1033.53000, 1032.33000, 1030.96000, 1029.43000, 1027.75000, 1025.93000, 1023.98000, 1021.90000, 1019.71000, 1017.41000, 1015.00000, 1012.49000, 1009.88000, 1007.17000, 1004.37000, 1001.49000,  998.50900,  995.44700,  992.30300,  989.07800,  985.77300,  982.39100,  978.93300,  975.39900,  971.79200,  964.36100,  956.64500,  948.64900,  940.37700,  931.82900,  923.00600,  913.90500,  904.52200,  894.85300,  884.89100,  874.62600,  864.05000,  853.15100,  841.91500,  830.32700,  818.37000,  806.02400,  793.26900,  780.08000,  766.43100,  752.29300,  737.63400,  722.41900,  706.60900,  690.16500,  646.01000,  597.04000,  543.17000,  485.93000,  429.18000,  377.56000,  334.22000,  299.47000,  250.00000,  217.46000,  194.44000,  177.14000,  163.51000,  152.41000,  143.13000,  135.19000,  131.91000 },
    { 1046.87000, 1046.78000, 1045.92000, 1044.86000, 1043.62000, 1042.22000, 1040.67000, 1038.99000, 1037.19000, 1035.27000, 1033.25000, 1031.12000, 1028.88000, 1026.55000, 1024.13000, 1021.62000, 1019.02000, 1016.34000, 1013.58000, 1010.73000, 1007.81000, 1004.81000, 1001.74000,  998.59000,  995.37300,  992.08700,  988.73200,  985.31100,  981.82300,  974.65500,  967.23500,  959.56800,  951.65900,  943.51100,  935.12600,  926.50500,  917.64700,  908.55100,  899.21500,  889.63500,  879.80700,  869.72700,  859.38700,  848.78300,  837.90500,  826.74600,  815.29700,  803.55000,  791.49300,  779.11700,  766.41200,  753.36600,  739.96900,  726.21200,  690.18000,  651.77000,  611.07000,  568.52000,  525.06000,  482.23000,  441.66000,  404.66000,  343.61000,  298.61000,  265.45000,  240.32000,  220.62000,  204.71000,  191.53000,  180.37000,  175.78000 },
    { 1087.98000, 1087.46000, 1086.21000, 1084.72000, 1083.06000, 1081.27000, 1079.38000, 1077.41000, 1075.37000, 1073.26000, 1071.10000, 1068.89000, 1066.62000, 1064.30000, 1061.92000, 1059.50000, 1057.02000, 1054.49000, 1051.91000, 1049.28000, 1046.60000, 1043.87000, 1041.09000, 1038.25000, 1035.38000, 1032.45000, 1029.47000, 1026.45000, 1023.39000, 1020.28000, 1017.12000, 1010.68000, 1004.08000,  997.31200,  990.39000,  983.31600,  976.09600,  968.73400,  961.23300,  953.59600,  945.82800,  937.92900,  929.90300,  921.75200,  913.47800,  905.08300,  896.56900,  887.93700,  879.18900,  870.32800,  861.35400,  852.27100,  843.07900,  833.78200,  824.38300,  814.88300,  790.72000,  766.01000,  740.84000,  715.30000,  689.52000,  663.65000,  637.89000,  612.45000,  563.38000,  518.03000,  477.38000,  441.66000,  410.60000,  383.70000,  360.35000,  340.01000,  331.52000 },
    { 1144.46000, 1144.39000, 1142.35000, 1140.15000, 1137.84000, 1135.47000, 1133.06000, 1130.61000, 1128.14000, 1125.66000, 1123.17000, 1120.67000, 1118.16000, 1115.64000, 1113.11000, 1110.57000, 1108.01000, 1105.44000, 1102.85000, 1100.24000, 1097.62000, 1094.97000, 1092.31000, 1089.62000, 1086.92000, 1084.19000, 1081.44000, 1078.67000, 1075.88000, 1073.07000, 1067.38000, 1061.61000, 1055.76000, 1049.83000, 1043.83000, 1037.76000, 1031.62000, 1025.41000, 1019.14000, 1012.82000, 1006.44000, 1000.01000,  993.52300,  986.99400,  980.42100,  973.80700,  967.15300,  960.46300,  953.73800,  946.98200,  940.19500,  933.38100,  926.54300,  919.68100,  912.79800,  895.52000,  878.15000,  860.74000,  843.32000,  825.93000,  808.59000,  791.35000,  774.24000,  740.52000,  707.72000,  676.11000,  645.93000,  617.41000,  590.69000,  565.84000,  542.84000,  532.86000 },
    { 1183.60000, 1181.96000, 1179.45000, 1176.90000, 1174.34000, 1171.77000, 1169.19000, 1166.62000, 1164.05000, 1161.49000, 1158.92000, 1156.37000, 1153.81000, 1151.26000, 1148.71000, 1146.15000, 1143.59000, 1141.03000, 1138.47000, 1135.90000, 1133.32000, 1130.73000, 1128.14000, 1125.54000, 1122.92000, 1120.30000, 1117.67000, 1112.38000, 1107.05000, 1101.68000, 1096.27000, 1090.82000, 1085.34000, 1079.82000, 1074.27000, 1068.70000, 1063.09000, 1057.46000, 1051.80000, 1046.12000, 1040.42000, 1034.71000, 1028.97000, 1023.23000, 1017.47000, 1011.70000, 1005.92000, 1000.14000,  994.34500,  988.54900,  982.75000,  976.95000,  962.45000,  947.98000,  933.54000,  919.17000,  904.88000,  890.69000,  876.62000,  862.67000,  835.22000,  808.44000,  782.41000,  757.19000,  732.85000,  709.44000,  687.01000,  665.59000,  656.08000 },
    { 1212.69000, 1210.98000, 1208.38000, 1205.79000, 1203.20000, 1200.62000, 1198.05000, 1195.50000, 1192.95000, 1190.41000, 1187.88000, 1185.36000, 1182.84000, 1180.33000, 1177.82000, 1175.31000, 1172.81000, 1170.31000, 1167.80000, 1165.30000, 1162.79000, 1160.29000, 1157.78000, 1155.27000, 1150.23000, 1145.18000, 1140.12000, 1135.04000, 1129.95000, 1124.84000, 1119.71000, 1114.58000, 1109.43000, 1104.27000, 1099.10000, 1093.92000, 1088.73000, 1083.54000, 1078.34000, 1073.14000, 1067.94000, 1062.74000, 1057.54000, 1052.34000, 1047.15000, 1041.96000, 1036.77000, 1031.59000, 1026.41000, 1013.50000, 1000.70000,  987.91000,  975.24000,  962.67000,  950.20000,  937.86000,  925.64000,  901.63000,  878.21000,  855.43000,  833.31000,  811.87000,  791.12000,  771.06000,  751.68000,  743.01000 },
    { 1237.39000, 1234.94000, 1232.38000, 1229.83000, 1227.29000, 1224.77000, 1222.26000, 1219.77000, 1217.28000, 1214.81000, 1212.34000, 1209.88000, 1207.43000, 1204.98000, 1202.54000, 1200.10000, 1197.67000, 1195.24000, 1192.82000, 1190.39000, 1187.97000, 1183.12000, 1178.28000, 1173.44000, 1168.60000, 1163.75000, 1158.91000, 1154.06000, 1149.22000, 1144.37000, 1139.52000, 1134.67000, 1129.83000, 1124.98000, 1120.14000, 1115.31000, 1110.47000, 1105.65000, 1100.83000, 1096.02000, 1091.21000, 1086.42000, 1081.63000, 1076.85000, 1072.09000, 1067.33000, 1055.50000, 1043.80000, 1032.10000, 1020.50000, 1009.10000,  997.76000,  986.55000,  975.46000,  953.67000,  932.43000,  911.77000,  891.69000,  872.20000,  853.30000,  834.99000,  817.25000,  809.28000 },
};

auto waterDensityWagnerPrussInterp(real const& T, real const& P) -> real
{
    const auto PMPa = P * 1e-6; // from Pa to MPa

    const Index iP = std::lower_bound(pressures.begin(), pressures.end(), PMPa) - pressures.begin();
    const Index iT = std::lower_bound(temperatures[iP].begin(), temperatures[iP].end(), T) - temperatures[iP].begin();

    const Index iPmax = iT < transitions[iP] ? pressures.size() : iP; // check if (T, P) is within liquid/supercritical state

    // Set indices of pressures so that if there is phase transition along pressure, pressures below that value are used
    const Index iP0 = iPmax > 2 ? std::min(iPmax - 3, iP) : 0;
    const Index iP1 = iPmax > 1 ? iP0 + 1 : 0;
    const Index iP2 = iPmax > 0 ? iP1 + 1 : 0;

    auto interpolateAtT = [&](Index indexP)
    {
        auto const& Ts = temperatures[indexP];
        auto const& Ds = densities[indexP];

        const Index iT = std::lower_bound(Ts.begin(), Ts.end(), T) - Ts.begin();

        const auto iTtran = std::min(transitions[indexP], Ts.size()); // use min in case transitions[indexP] == 99
        const auto iTmax = iT < transitions[indexP] ? iTtran : Ts.size(); // used for ensuring that interpolation is performed within same state of matter

        // Set indices of temperature so that if there is phase transition along temperature, temperatures below that value are used
        const Index iT0 = std::min(iTmax - 3, iT);
        const Index iT1 = iT0 + 1;
        const Index iT2 = iT0 + 2;

        return interpolateQuadratic(T, Ts[iT0], Ts[iT1], Ts[iT2], Ds[iT0], Ds[iT1], Ds[iT2]);
    };

    const auto P0 = pressures[iP0];
    const auto P1 = pressures[iP1];
    const auto P2 = pressures[iP2];

    const auto D0 = interpolateAtT(iP0); // density at T and P=P0
    const auto D1 = interpolateAtT(iP1); // density at T and P=P1
    const auto D2 = interpolateAtT(iP2); // density at T and P=P2

    return interpolateQuadratic(PMPa, P0, P1, P2, D0, D1, D2);
}

} // namespace Reaktoro
