#-------------------------------------------------------------
# This script assumes it is executed from CMAKE_SOURCE_DIR.
# In other words, from the root of the main project.
#-------------------------------------------------------------

# Set the build type to Release by default, if not provided
if(NOT DEFINED BUILD_TYPE)
    set(BUILD_TYPE Release)
endif()

# Set the BUILD_PATH variable
if(NOT DEFINED BUILD_PATH)
    set(BUILD_PATH ${CMAKE_SOURCE_DIR}/deps/build)
endif()

# Create the build directory for the external dependencies
execute_process(COMMAND ${CMAKE_COMMAND} -E make_directory ${BUILD_PATH})

# Configure the installation of the external dependencies
execute_process(COMMAND
    ${CMAKE_COMMAND} -E chdir ${BUILD_PATH}
    ${CMAKE_COMMAND} -G Ninja ${CMAKE_SOURCE_DIR}/deps
        -DCMAKE_BUILD_TYPE=${BUILD_TYPE}
        -DCMAKE_INSTALL_PREFIX=${BUILD_PATH}/install)

# Build and install the external dependencies
execute_process(COMMAND ${CMAKE_COMMAND} --build ${BUILD_PATH})
